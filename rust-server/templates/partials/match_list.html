<section class="match-list-tab">
    <h2>Match History</h2>

    <div class="match-filters">
        <select name="hero_id" hx-get="/htmx/matches" hx-target="#match-list-content" hx-include="[name='outcome']">
            <option value="">All Heroes</option>
            {% for hero in heroes %}
            <option value="{{ hero.id }}" {% if selected_hero_id == hero.id %}selected{% endif %}>{{ hero.name }}</option>
            {% endfor %}
        </select>

        <select name="outcome" hx-get="/htmx/matches" hx-target="#match-list-content" hx-include="[name='hero_id']">
            <option value="">All Outcomes</option>
            <option value="win" {% if selected_outcome == "win" %}selected{% endif %}>Wins</option>
            <option value="loss" {% if selected_outcome == "loss" %}selected{% endif %}>Losses</option>
        </select>
    </div>

    <div class="match-summary">
        <span>{{ total_matches }} matches found</span>
        {% if total_pages > 0 %}
        <span>Page {{ current_page }} of {{ total_pages }}</span>
        {% endif %}
    </div>

    <div id="match-list-content" class="match-cards">
        {% if matches.is_empty() %}
        <p class="no-matches">No matches found. Try adjusting your filters or loading data first.</p>
        {% else %}
        {% for m in matches %}
        <div class="match-card {% if m.won %}match-win{% else %}match-loss{% endif %}">
            <div class="match-header">
                <span class="match-id">#{{ m.match_id }}</span>
                <span class="match-result {% if m.won %}win{% else %}loss{% endif %}">
                    {% if m.won %}Victory{% else %}Defeat{% endif %}
                </span>
            </div>
            <div class="match-hero">
                <strong>{{ m.hero_name }}</strong>
            </div>
            <div class="match-stats">
                <span class="kda">{{ m.kda }}</span>
                <span class="net-worth">{{ m.net_worth }} souls</span>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>

    {% if total_pages > 1 %}
    <div class="pagination">
        {% if current_page > 1 %}
        <button hx-get="/htmx/matches?page={{ current_page - 1 }}{% if selected_hero_id != 0 %}&hero_id={{ selected_hero_id }}{% endif %}{% if selected_outcome != "" %}&outcome={{ selected_outcome }}{% endif %}"
                hx-target="#match-list-content"
                class="page-btn">
            Previous
        </button>
        {% endif %}

        <span class="page-info">{{ current_page }} / {{ total_pages }}</span>

        {% if current_page < total_pages %}
        <button hx-get="/htmx/matches?page={{ current_page + 1 }}{% if selected_hero_id != 0 %}&hero_id={{ selected_hero_id }}{% endif %}{% if selected_outcome != "" %}&outcome={{ selected_outcome }}{% endif %}"
                hx-target="#match-list-content"
                class="page-btn">
            Next
        </button>
        {% endif %}
    </div>
    {% endif %}
</section>
